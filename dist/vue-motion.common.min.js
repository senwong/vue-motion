"use strict";var msPerFrame=1/60,precision=.01;function oneFrameDistance(t,n,i,e,s){void 0===s&&(s=1),(Number.isNaN(t)||Number.isNaN(n)||Number.isNaN(i))&&console.error("onFrameDistance("+t+", "+n+", "+i+")"),console.log({stiffness:e.stiffness,damping:e.damping});var o=e.stiffness,a=e.damping,r=-Math.abs(n-t),l=(-o*r+-a*i)/1e3;r+=i+=l*s;var c=n>t?n+r:n-r;return{value:c=Math.round(1e3*c)/1e3,velocity:i,acceleration:l}}function createAnimate(t,n,i){var e,s=t;return function(t){if(s!==t){e&&window.cancelAnimationFrame(e);var o,a=0,r=0,l=0;o=performance.now(),function c(){var u=performance.now(),f=(u-o)/1e3;o=u;var p=Math.floor((r+f)/msPerFrame);l+=p,r+=f-p*msPerFrame;var m=oneFrameDistance(s,t,a,i,p),d=m.value,g=m.velocity,h=m.acceleration;s=d,a=g,l>0&&Math.abs(h)<precision&&Math.abs(a)<precision?n(t):(n(s),e=window.requestAnimationFrame(function(){c()}))}()}}}var Motion={template:'\n    <div>\n      <slot v-bind:styles="interpolatingStyles"></slot>\n    </div>\n  ',data:function(){return{interpolatingStyles:{},options:{stiffness:null,damping:null}}},props:{styles:{required:!0},stiffness:{type:Number,default:100,validator:function(t){return t>0}},damping:{type:Number,default:370,validator:function(t){return t>0}}},watch:{stiffness:function(t){this.options.stiffness=t},damping:function(t){this.options.damping=t}},created:function(){var t=this;this.initialOptions(),this.interpolatingStyles=Object.assign({},this.styles),Object.keys(this.styles).map(function(n){var i=createAnimate(t.styles[n],function(i){return t.interpolatingStyles[n]=i},t.options);t.$watch("styles."+n,function(t){return i(t)})})},methods:{initialOptions:function(){this.options.stiffness=this.stiffness,this.options.damping=this.damping}}},StaggeredMotion={template:'\n    <div>\n      <slot v-bind:styles="interpolatingStyles"></slot>\n    </div>\n  ',data:function(){return{interpolatingStyles:[],options:{stiffness:null,damping:null}}},props:{styles:{required:!0},stiffness:{type:Number,default:20,validator:function(t){return t>0}},damping:{type:Number,default:370,validator:function(t){return t>0}},enable:{type:Boolean,default:!0}},created:function(){this.initial(),this.initialOptions(),this.watchLeadingStyle(),this.watchInterpolatingStyles()},watch:{stiffness:function(t){this.options.stiffness=t},damping:function(t){this.options.damping=t}},methods:{initial:function(){this.interpolatingStyles=this.styles.map(function(t){return Object.assign({},t)})},initialOptions:function(){this.options.stiffness=this.stiffness,this.options.damping=this.damping},watchLeadingStyle:function(){var t=this;Object.keys(this.styles[0]).map(function(n){var i=createAnimate(t.styles[0][n],function(i){return t.interpolatingStyles[0][n]=i},t.options);t.$watch(function(){return t.styles[0][n]},function(t){return i(t)})})},watchInterpolatingStyles:function(){var t=this;this.interpolatingStyles.map(function(n,i){i>=t.interpolatingStyles.length-1||Object.keys(n).map(function(n){var e=i+1,s=t.interpolatingStyles[e][n],o=0;t.$watch(function(){return t.interpolatingStyles[i][n]},function(i){if(i===t.styles[0][n]){createAnimate(t.interpolatingStyles[e][n],function(i){return t.interpolatingStyles[e][n]=i},t.options)(i)}else{var a=oneFrameDistance(s,i,o,t.options);s=a.value,o=a.velocity,t.interpolatingStyles[e][n]=s}})})})}}},VueMotion={install:function(t,n){t.component("Motion",Motion),t.component("StaggeredMotion",StaggeredMotion)},Motion:Motion,StaggeredMotion:StaggeredMotion};module.exports=VueMotion;
